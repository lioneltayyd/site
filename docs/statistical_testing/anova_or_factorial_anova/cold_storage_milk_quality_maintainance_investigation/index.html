

<!DOCTYPE html>
<html lang="en">

    <head>

        

    <script type="application/ld+json">

    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Cold Storage Milk Quality Maintainance Investigation",
    "url": "https:\/\/lionelcub.github.io\/site\/statistical_testing\/anova_or_factorial_anova\/cold_storage_milk_quality_maintainance_investigation\/",
    "wordCount": "1970",
    "datePublished": "2020-05-01T22:36:38\x2b08:00",
    "dateModified": "2020-05-01T22:36:38\x2b08:00",
    "author": {
        "@type": "Person",
        "name": "Lionel Tay"
    }
    }

    </script> 



        <title>
    Cold Storage Milk Quality Maintainance Investigation
</title>


        
        <meta property="og:title" content="Cold Storage Milk Quality Maintainance Investigation" />
<meta property="og:description" content="Cold Storage Milk Quality Maintainance Investigation. Project purpose. Cold Storage started its operations in Jan 2016. They are in the business of storing Pasteurized Fresh Whole or Skimmed Milk, Sweet Cream, Flavoured Milk Drinks. To ensure that there is no change of texture, body appearance, separation of fats the optimal temperature to be maintained is between 2—4°C.
In the first year of business, they outsourced the plant maintenance work to a professional company with stiff penalty clauses." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lionelcub.github.io/site/statistical_testing/anova_or_factorial_anova/cold_storage_milk_quality_maintainance_investigation/" />
<meta property="article:published_time" content="2020-05-01T22:36:38&#43;08:00"/>
<meta property="article:modified_time" content="2020-05-01T22:36:38&#43;08:00"/>

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cold Storage Milk Quality Maintainance Investigation"/>
<meta name="twitter:description" content="Cold Storage Milk Quality Maintainance Investigation. Project purpose. Cold Storage started its operations in Jan 2016. They are in the business of storing Pasteurized Fresh Whole or Skimmed Milk, Sweet Cream, Flavoured Milk Drinks. To ensure that there is no change of texture, body appearance, separation of fats the optimal temperature to be maintained is between 2—4°C.
In the first year of business, they outsourced the plant maintenance work to a professional company with stiff penalty clauses."/>
<meta name="generator" content="Hugo 0.55.6" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta charset="UTF-8">
        <meta name="author" content=""/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
        
        <meta name="description" content="Cold Storage Milk Quality Maintainance Investigation. Project purpose. Cold Storage started its operations in Jan 2016. They are in the business of storing Pasteurized Fresh Whole or Skimmed Milk, Sweet Cream, Flavoured Milk Drinks. To ensure that there is no change of texture, body appearance, separation of fats the optimal temperature to be maintained is between 2—4°C.
In the first year of business, they outsourced the plant maintenance work to a professional company with stiff penalty clauses."/>
        


        
        <link 
            rel="stylesheet" 
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" 
            integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" 
            crossorigin="anonymous">
        

        
        <script src="https://kit.fontawesome.com/c14bcac617.js"></script>

        

        
        
        <link href="https://lionelcub.github.io/site/css/custom.css" rel="stylesheet">
        <link href="https://lionelcub.github.io/site/css/syntax.css" rel="stylesheet">


        
        <link 
            href="https://fonts.googleapis.com/css?family=Martel:400,600,700|Montserrat:300,400,500,600,700|Muli:300,300i,400,400i,600,600i,700,700i,800,900|PT+Serif:400,400i,700,700i|Cutive+Mono|PT+Mono&display=swap&subset=latin-ext" 
            rel="stylesheet">
        


        
        <script 
    type="text/javascript"
    src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' 
    async>
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

    </head>

    <body>

        
        <nav class="navbar navbar-expand-sm fixed-top">
            <div class="container">
                <a class="navbar-brand" href="https://lionelcub.github.io/site/">Lionel Tay Yee Dang</a>
                <button 
                    class="navbar-toggler" 
                    type="button" 
                    data-toggle="collapse" 
                    data-target="#navbarSupportedContent" 
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false" 
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">   
                    <ul class="nav navbar-nav mr-auto"></ul>
                    <ul class="navbar-nav">

                        <li class="nav-item dropdown">
                            <a 
                                class="nav-link dropdown-toggle" 
                                href="#" 
                                id="navbarDropdown" 
                                role="button" 
                                data-toggle="dropdown" 
                                aria-haspopup="true"
                                aria-expanded="false">
                                About
                            </a>
                            <div class="dropdown-menu dropdown-menu-left" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="https://lionelcub.github.io/site/about/about_me/">About Me</a>
                                <a class="dropdown-item" href="https://github.com/lionelcub">GitHub</a>
                                <a class="dropdown-item" href="https://www.linkedin.com/in/lioneltayyd">LinkedIn</a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a 
                                class="nav-link dropdown-toggle" 
                                href="#" 
                                id="navbarDropdown" 
                                role="button" 
                                data-toggle="dropdown" 
                                aria-haspopup="true"
                                aria-expanded="false">
                                Projects
                            </a>

                            <div class="dropdown-menu dropdown-menu-left" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="https://lionelcub.github.io/site/applied_domain/financial_market">Applied Domain</a>
                                <a class="dropdown-item" href="https://lionelcub.github.io/site/statistical_testing/anova_or_factorial_anova">Statistical Testing</a>
                                <a class="dropdown-item" href="https://lionelcub.github.io/site/dashboard_visualisation/bokeh_dashboard">Dashboard Visualisation</a>
                                <a class="dropdown-item" href="https://lionelcub.github.io/site/machine_learning/price_estimation">Machine Learning</a>
                                <a class="dropdown-item" href="https://lionelcub.github.io/site/working_process/data_collecting">Data Working Process</a>
                                <a class="dropdown-item" href="https://lionelcub.github.io/site/analytical_tools/python">Analytical Tools</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="https://lionelcub.github.io/site/notes">Notes</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="https://lionelcub.github.io/site/blog">Blog</a>
                        </li>

                    </ul>
                </div>

            </div>
        </nav>


        
        
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
        
                     


<article>
  
  <div class="technical_note">
    <div class="content">    
      

<h1 id="cold-storage-milk-quality-maintainance-investigation">Cold Storage Milk Quality Maintainance Investigation.</h1>

<hr />

<h2 id="project-purpose">Project purpose.</h2>

<p>Cold Storage started its operations in Jan 2016. They are in the
business of storing Pasteurized Fresh Whole or Skimmed Milk, Sweet
Cream, Flavoured Milk Drinks. To ensure that there is no change of
texture, body appearance, separation of fats the <strong>optimal temperature
to be maintained is between 2—4°C</strong>.</p>

<p>In the first year of business, they outsourced the plant maintenance
work to a professional company with stiff penalty clauses. It was agreed
that if it was statistically proven that the probability of temperature
going <strong>outside the 2—4°C</strong> during the one-year contract was <strong>above
2.5% and less than 5%</strong> then the <strong>penalty would be 10% of AMC (annual
maintenance contract)</strong>. In case it <strong>exceeded 5%</strong> then the <strong>penalty
would be 25% of the AMC fee</strong>.</p>

<p>The objective is to find proportion of milk temperature that exceed
<strong>below 2°C</strong> or <strong>above 4°C</strong> and determine the penalty Cold Storage
should impose based on the contract should the company exceed the
limits.</p>

<hr />

<h2 id="1-explore-and-familiarise-with-the-cold-storage-temp-dataset">1 Explore and familiarise with the ‘Cold_Storage_Temp’ dataset.</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>pacman<span class="p">)</span>
p_load<span class="p">(</span>readr<span class="p">,</span> dplyr<span class="p">,</span> plyr<span class="p">,</span> ggplot2<span class="p">,</span> car<span class="p">,</span> sjstats<span class="p">,</span> multcomp<span class="p">,</span> nortest<span class="p">,</span> pwr<span class="p">,</span> reshape2<span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">CS.temp <span class="o">=</span> read_csv<span class="p">(</span><span class="s">&#34;csv/Cold_Storage_Temp_Data.csv&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Season = col_character(),
##   Month = col_character(),
##   Date = col_double(),
##   Temperature = col_double()
## )
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">CS.temp</code></pre></div>
<pre><code>## # A tibble: 365 x 4
##    Season Month  Date Temperature
##    &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt;
##  1 Winter Jan       1         2.3
##  2 Winter Jan       2         2.2
##  3 Winter Jan       3         2.4
##  4 Winter Jan       4         2.8
##  5 Winter Jan       5         2.5
##  6 Winter Jan       6         2.4
##  7 Winter Jan       7         2.8
##  8 Winter Jan       8         3  
##  9 Winter Jan       9         2.4
## 10 Winter Jan      10         2.9
## # … with 355 more rows
</code></pre>

<hr />

<h3 id="1-1-summarise-of-the-dataset">1.1 Summarise of the dataset.</h3>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">summary</span><span class="p">(</span>CS.temp<span class="p">)</span></code></pre></div>
<pre><code>##     Season             Month                Date        Temperature   
##  Length:365         Length:365         Min.   : 1.00   Min.   :1.700  
##  Class :character   Class :character   1st Qu.: 8.00   1st Qu.:2.700  
##  Mode  :character   Mode  :character   Median :16.00   Median :3.000  
##                                        Mean   :15.72   Mean   :3.002  
##                                        3rd Qu.:23.00   3rd Qu.:3.300  
##                                        Max.   :31.00   Max.   :4.500
</code></pre>

<hr />

<h3 id="1-2-transform-dtype">1.2 Transform dtype.</h3>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">CS.temp<span class="o">$</span>Season <span class="o">=</span> <span class="kp">as.factor</span><span class="p">(</span>CS.temp<span class="o">$</span>Season<span class="p">)</span>
CS.temp<span class="o">$</span>Month <span class="o">=</span> <span class="kp">as.factor</span><span class="p">(</span>CS.temp<span class="o">$</span>Month<span class="p">)</span>

<span class="c1"># Summarise the dataset. </span>
<span class="kp">summary</span><span class="p">(</span>CS.temp<span class="p">)</span></code></pre></div>
<pre><code>##     Season        Month          Date        Temperature   
##  Rainy :122   Aug    : 31   Min.   : 1.00   Min.   :1.700  
##  Summer:120   Dec    : 31   1st Qu.: 8.00   1st Qu.:2.700  
##  Winter:123   Jan    : 31   Median :16.00   Median :3.000  
##               Jul    : 31   Mean   :15.72   Mean   :3.002  
##               Mar    : 31   3rd Qu.:23.00   3rd Qu.:3.300  
##               May    : 31   Max.   :31.00   Max.   :4.500  
##               (Other):179
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Standard deviation.</span>
sd<span class="p">(</span>CS.temp<span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## [1] 0.4658319
</code></pre>

<hr />

<h3 id="1-3-summarise-of-the-dataset-by-season-variable">1.3 Summarise of the dataset by ‘Season’ variable.</h3>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">CS.temp.summary.season <span class="o">=</span> ddply<span class="p">(</span><span class="m">.</span>data<span class="o">=</span>CS.temp<span class="p">,</span> <span class="m">.</span>variable<span class="o">=</span> <span class="o">~</span> Season<span class="p">,</span> <span class="m">.</span>fun<span class="o">=</span><span class="kr">function</span><span class="p">(</span>data<span class="p">)</span> <span class="kp">summary</span><span class="p">(</span>data<span class="o">$</span>Temperature<span class="p">))</span>
CS.temp.summary.season</code></pre></div>
<pre><code>##   Season Min. 1st Qu. Median     Mean 3rd Qu. Max.
## 1  Rainy  1.7    2.70   3.05 3.087705     3.4  4.5
## 2 Summer  2.5    2.90   3.20 3.147500     3.4  4.0
## 3 Winter  1.8    2.45   2.80 2.776423     3.0  3.9
</code></pre>

<hr />

<h3 id="1-4-check-the-detail-of-the-dataset">1.4 Check the detail of the dataset.</h3>

<p><strong>The overview includes the following:</strong></p>

<ol>
<li>Check the proportion of nulls.</li>
<li>Check if there’s any duplicated rows.</li>
</ol>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">dataset_detail <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>df<span class="p">)</span> <span class="p">{</span>
    na_count <span class="o">=</span> <span class="kp">colSums</span><span class="p">(</span><span class="kp">is.na</span><span class="p">(</span>df<span class="p">))</span>
    
    <span class="c1"># Details. </span>
    nulls_proportion <span class="o">=</span> na_count <span class="o">/</span> <span class="kp">nrow</span><span class="p">(</span>df<span class="p">)</span> <span class="o">*</span> <span class="m">100</span>
    duplicated_nrows <span class="o">=</span> <span class="kp">nrow</span><span class="p">(</span><span class="kp">which</span><span class="p">(</span><span class="kp">duplicated</span><span class="p">(</span>df<span class="p">)))</span>
    
    details <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>nulls_proportion<span class="p">,</span> duplicated_nrows<span class="p">)</span>
    <span class="kp">names</span><span class="p">(</span>details<span class="p">)</span> <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;nulls_proportion&#34;</span><span class="p">,</span> <span class="s">&#34;duplicated_nrows&#34;</span><span class="p">)</span>
    <span class="kr">return</span><span class="p">(</span>details<span class="p">)</span>
<span class="p">}</span>
    
CS.temp.details <span class="o">=</span> dataset_detail<span class="p">(</span>CS.temp<span class="p">)</span>
CS.temp.details</code></pre></div>
<pre><code>## $nulls_proportion
##      Season       Month        Date Temperature 
##           0           0           0           0 
## 
## $duplicated_nrows
## NULL
</code></pre>

<hr />

<h3 id="1-5-visualise-the-density-distribution-for-temperature-variable">1.5 Visualise the density distribution for ‘Temperature’ variable.</h3>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">ggplot<span class="p">(</span>data<span class="o">=</span>CS.temp<span class="p">)</span> <span class="o">+</span>
    aes<span class="p">(</span>x<span class="o">=</span>Temperature<span class="p">)</span> <span class="o">+</span>
    geom_density<span class="p">(</span>fill<span class="o">=</span><span class="s">&#34;grey&#34;</span><span class="p">)</span></code></pre></div>
<p><img src="unnamed-chunk-7-1.png" alt="" /></p>

<hr />

<h3 id="1-6-visualise-the-distribution-for-temperature-variable-by-season">1.6 Visualise the distribution for ‘Temperature’ variable by ‘Season’.</h3>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">ggplot<span class="p">(</span>data<span class="o">=</span>CS.temp<span class="p">)</span> <span class="o">+</span>
    aes<span class="p">(</span>x<span class="o">=</span>Season<span class="p">,</span> y<span class="o">=</span>Temperature<span class="p">)</span> <span class="o">+</span>
    geom_boxplot<span class="p">()</span> <span class="o">+</span> 
    geom_hline<span class="p">(</span>yintercept<span class="o">=</span><span class="m">4.</span><span class="p">,</span> color<span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> alpha<span class="o">=</span><span class="m">.5</span><span class="p">)</span> <span class="o">+</span>
    geom_hline<span class="p">(</span>yintercept<span class="o">=</span><span class="m">2.</span><span class="p">,</span> color<span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> alpha<span class="o">=</span><span class="m">.5</span><span class="p">)</span></code></pre></div>
<p><img src="unnamed-chunk-8-1.png" alt="" /></p>

<hr />

<h3 id="1-7-visualise-the-density-distribution-for-temperature-variable-by-season">1.7 Visualise the density distribution for ‘Temperature’ variable by ‘Season’.</h3>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">ggplot<span class="p">(</span>data<span class="o">=</span>CS.temp<span class="p">)</span> <span class="o">+</span>
    aes<span class="p">(</span>x<span class="o">=</span>Temperature<span class="p">,</span> fill<span class="o">=</span>Season<span class="p">)</span> <span class="o">+</span>
    geom_density<span class="p">(</span>alpha<span class="o">=</span><span class="m">.4</span><span class="p">)</span></code></pre></div>
<p><img src="unnamed-chunk-9-1.png" alt="" /></p>

<hr />

<h3 id="1-8-summary-for-section-1">1.8 Summary for section 1:</h3>

<p><strong>Data dictionary:</strong></p>

<p>This dataset has 365 row. Each row refers to each date. The counts for
each unique value of the <code>Season</code> variable is about 120 rows, which is
quite balanced.</p>

<ol>
<li><strong>Season:</strong> Rainy, Summer, Winter.</li>
<li><strong>Month:</strong> 1—12.</li>
<li><strong>Date:</strong> It refers to the day of the month.</li>
<li><strong>Temperature:</strong> <strong>Average milk temperature</strong> on that day.</li>
</ol>

<p><strong>Assumption on the dataset:</strong></p>

<p>The milk temperature is calculated based on average. Meaning even if one
of the milk product’s temperature exceeds 2°C or 4°C, it will not
considered a violation to the contract as long as the average is within
2—4°C.</p>

<p><strong>Findings from section 1.3:</strong></p>

<ol>
<li>The dataset contains 3 independant variables and 1 dependent
variable which is <code>Temperature</code>.</li>
<li><code>Date</code> is nested within <code>Month</code> variable, and <code>Month</code> variable is
nested within <code>Season</code> variable.</li>
<li><code>Date</code> variable is not a fixed effect. It is a random effect nested
within <code>Season</code> and <code>Month</code> variables.</li>
<li><code>Season</code> is a ‘between’ variable. <code>Month</code> is a ‘within’ variable.</li>
</ol>

<p><strong>Findings from section 1.4:</strong></p>

<ol>
<li>The dataset has no null row.</li>
<li>The dataset has no duplicated row.</li>
</ol>

<p><strong>Findings from section 1.5, 1.6, and 1.7:</strong></p>

<ol>
<li>The <code>Temperature</code> variable seems to be normally distributed on
overall.</li>
<li>The <code>Temperature</code> for <code>Winter</code> and <code>Rainy</code> season is slighly right
skewed.</li>
<li>The <code>Temperature</code> for <code>Summer</code> seems to be normally distributed.</li>
</ol>

<hr />

<h2 id="2-find-the-proportion-of-temperature-that-exceed-below-2-c-and-above-4-c">2 Find the proportion of temperature that exceed below 2°C and above 4°C.</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Proportion below 2°C.</span>
temp.below.2 <span class="o">=</span> <span class="kp">sum</span><span class="p">(</span>CS.temp<span class="o">$</span>Temperature <span class="o">&lt;</span> <span class="m">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="kp">nrow</span><span class="p">(</span>CS.temp<span class="p">)</span>
temp.below.2</code></pre></div>
<pre><code>## [1] 0.008219178
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Proportion above 4°C.</span>
temp.above.4 <span class="o">=</span> <span class="kp">sum</span><span class="p">(</span>CS.temp<span class="o">$</span>Temperature <span class="o">&gt;</span> <span class="m">4.0</span><span class="p">)</span> <span class="o">/</span> <span class="kp">nrow</span><span class="p">(</span>CS.temp<span class="p">)</span>
temp.above.4</code></pre></div>
<pre><code>## [1] 0.01917808
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Total proportion that exceed the limits. </span>
temp.below.2 <span class="o">+</span> temp.above.4</code></pre></div>
<pre><code>## [1] 0.02739726
</code></pre>

<hr />

<h2 id="3-perform-one-way-anova-to-see-if-there-is-significant-difference-in-milk-temperature-between-different-seasons">3 Perform One-way ANOVA to see if there is significant difference in milk temperature between different seasons.</h2>

<p><strong>Null hypothesis:</strong> mu(Rainy) = mu(Summer) = mu(Winter)</p>

<p><strong>Alternative hypothesis:</strong> At least 1 mean is different
from the rest.</p>

<hr />

<p><strong>Conditions for One-way ANOVA:</strong></p>

<ol>
<li>Variance must be equal &gt;&gt; Do a Levene and Brown Forsythe test.</li>
<li>Data must normally distributed &gt;&gt; Do a Shapiro-Wilk and
Anderson-Darling test + QQ plot.</li>
<li>Data must be non-paired.</li>
</ol>

<p>One-way ANOVA is robust to slight imbalance between the sample size of
each season.</p>

<p><strong>Alternative methods to One-way ANOVA:</strong></p>

<ol>
<li>The limit of ANOVA robustness to heterogeneity is 1.5 ratio between
largest and smallest variance. If the variance is above 1.5 ratio,
consider using Kruskal Wallis test or Welch ANOVA. Unequal variance
will decrease power and therefore increases type 1 error. Here’s a
reference to the article <a href="https://link.springer.com/article/10.3758/s13428-017-0918-2">Effect of variance ratio on ANOVA
robustness: Might 1.5 be the
limit?</a>.</li>
<li>If data is not normally distributed, consider using Box-Cox
transformation. Otherwise, use Kruskal Wallis test.</li>
</ol>

<hr />

<h3 id="3-1-perform-an-assumption-test">3.1 Perform an assumption test.</h3>

<h4 id="3-1-1-perform-levene-and-brown-forsythe-test-for-variance">3.1.1 Perform Levene and Brown Forsythe test for variance.</h4>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Levene Test.</span>
leveneTest<span class="p">(</span>Temperature <span class="o">~</span> Season<span class="p">,</span> data<span class="o">=</span>CS.temp<span class="p">,</span> center<span class="o">=</span><span class="kp">mean</span><span class="p">)</span></code></pre></div>
<pre><code>## Levene's Test for Homogeneity of Variance (center = mean)
##        Df F value    Pr(&gt;F)    
## group   2  8.0498 0.0003798 ***
##       362                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Brown Forsythe Test.</span>
leveneTest<span class="p">(</span>Temperature <span class="o">~</span> Season<span class="p">,</span> data<span class="o">=</span>CS.temp<span class="p">,</span> center<span class="o">=</span>median<span class="p">)</span></code></pre></div>
<pre><code>## Levene's Test for Homogeneity of Variance (center = median)
##        Df F value    Pr(&gt;F)    
## group   2  8.0084 0.0003951 ***
##       362                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre>

<hr />

<h5 id="3-1-1-1-find-the-ratio-between-the-largest-and-smallest-variance">3.1.1.1 Find the ratio between the largest and smallest variance.</h5>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Calculate variance for each season. </span>
var<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## [1] 0.2779468
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">var<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## [1] 0.1236912
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">var<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Winter&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## [1] 0.1716527
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Calculate the ratio between largest and smallest variance. </span>
var<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span> <span class="o">/</span> var<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## [1] 2.247103
</code></pre>

<hr />

<h4 id="3-1-2-perform-shapiro-wilk-and-anderson-darling-test">3.1.2 Perform Shapiro-Wilk and Anderson-Darling test.</h4>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Perform normality test on temperature for &#39;Rainy&#39; season.</span>
shapiro.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  CS.temp[CS.temp$Season == &quot;Rainy&quot;, ]$Temperature
## W = 0.98665, p-value = 0.2766
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Perform normality test on temperature for &#39;Summer&#39; season.</span>
shapiro.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  CS.temp[CS.temp$Season == &quot;Summer&quot;, ]$Temperature
## W = 0.97336, p-value = 0.01747
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Perform normality test on temperature for &#39;Winter&#39; season.</span>
shapiro.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Winter&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  CS.temp[CS.temp$Season == &quot;Winter&quot;, ]$Temperature
## W = 0.98116, p-value = 0.08354
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Perform normality test on temperature for &#39;Rainy&#39; season.</span>
ad.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  CS.temp[CS.temp$Season == &quot;Rainy&quot;, ]$Temperature
## A = 0.63343, p-value = 0.09654
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Perform normality test on temperature for &#39;Summer&#39; season.</span>
ad.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  CS.temp[CS.temp$Season == &quot;Summer&quot;, ]$Temperature
## A = 0.80328, p-value = 0.03654
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Perform normality test on temperature for &#39;Winter&#39; season.</span>
ad.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Winter&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  CS.temp[CS.temp$Season == &quot;Winter&quot;, ]$Temperature
## A = 0.77636, p-value = 0.04264
</code></pre>

<hr />

<h4 id="3-1-3-visualise-the-normality-with-qq-plots">3.1.3 Visualise the normality with QQ plots.</h4>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">qqnorm<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> pch<span class="o">=</span><span class="m">1</span><span class="p">,</span> frame<span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
qqline<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span></code></pre></div>
<p><img src="unnamed-chunk-18-1.png" alt="" /></p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">qqnorm<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> pch<span class="o">=</span><span class="m">1</span><span class="p">,</span> frame<span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
qqline<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span></code></pre></div>
<p><img src="unnamed-chunk-18-2.png" alt="" /></p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">qqnorm<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Winter&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> pch<span class="o">=</span><span class="m">1</span><span class="p">,</span> frame<span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
qqline<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Winter&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span></code></pre></div>
<p><img src="unnamed-chunk-18-3.png" alt="" /></p>

<hr />

<h3 id="3-2-summary-for-section-3-1">3.2 Summary for section 3.1.</h3>

<p><strong>Findings from 3.1.1:</strong></p>

<ol>
<li>The data does fails the homogeneity test.</li>
<li>The variance ratio is larger than 1.5.</li>
</ol>

<p><strong>Findings from 3.1.2:</strong></p>

<ol>
<li>The normality fails for temperature under <code>Summer</code> season.</li>
<li>The normality is near the borderline p-value for temperature under
<code>Winter</code> season.</li>
</ol>

<p>This might be due to large sample size, larger sample size has higher
the chance of detecting smaller difference. Looking at the plot from
section 1.7, the data under summer (highlited with green) looks somewhat
symmetrical. The QQ plots also show that most of the data aren’t
significantly diverted from the line. Hence, I will take it as
near-normal.</p>

<p><strong>Next steps:</strong></p>

<p>I will do a Welch ANOVA test to address the unequal variance.</p>

<hr />

<h3 id="3-3-perform-anova-test">3.3 Perform ANOVA test.</h3>

<h4 id="3-3-1-perform-welch-anova-test">3.3.1 Perform Welch ANOVA test.</h4>

<p><strong>Null hypothesis:</strong> mu(Rainy) = mu(Summer) = mu(Winter)</p>

<p><strong>Alternative hypothesis:</strong> At least 1 mean is different
from the rest.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">aov.result <span class="o">=</span> oneway.test<span class="p">(</span>formula<span class="o">=</span>Temperature <span class="o">~</span> Season<span class="p">,</span> data<span class="o">=</span>CS.temp<span class="p">,</span> var.equal<span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
aov.result</code></pre></div>
<pre><code>## 
##  One-way analysis of means (not assuming equal variances)
## 
## data:  Temperature and Season
## F = 29.959, num df = 2.00, denom df = 236.22, p-value = 2.537e-12
</code></pre>

<hr />

<h4 id="3-3-2-perform-post-hoc-test-with-holm-bonferonni-correction">3.3.2 Perform post-hoc test with Holm Bonferonni correction.</h4>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Perform pairwise comparison pos-hoc test. </span>
ttest1 <span class="o">=</span> t.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> 
       CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> paired<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> exact<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> var.equal<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> alternative<span class="o">=</span><span class="s">&#39;two.sided&#39;</span><span class="p">)</span>
ttest2 <span class="o">=</span> t.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Summer&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> 
                  CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Winter&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> paired<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> exact<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> var.equal<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> alternative<span class="o">=</span><span class="s">&#39;two.sided&#39;</span><span class="p">)</span>
ttest3 <span class="o">=</span> t.test<span class="p">(</span>CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Winter&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> 
                  CS.temp<span class="p">[</span>CS.temp<span class="o">$</span>Season <span class="o">==</span> <span class="s">&#34;Rainy&#34;</span><span class="p">,]</span><span class="o">$</span>Temperature<span class="p">,</span> paired<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> exact<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> var.equal<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> alternative<span class="o">=</span><span class="s">&#39;two.sided&#39;</span><span class="p">)</span>

<span class="c1"># Apply Holm Bonferonni correction for p-value. </span>
p.adjust<span class="p">(</span><span class="kt">c</span><span class="p">(</span>ttest1<span class="o">$</span>p.value<span class="p">,</span> ttest2<span class="o">$</span>p.value<span class="p">,</span> ttest3<span class="o">$</span>p.value<span class="p">),</span> method<span class="o">=</span><span class="s">&#34;holm&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>## [1] 2.997695e-01 3.128108e-12 1.200527e-06
</code></pre>

<hr />

<h3 id="3-4-summary-for-section-3-3">3.4 Summary for section 3.3.</h3>

<p><strong>Findings:</strong></p>

<ul>
<li>The Welch ANOVA show a significant difference for temperature
between either season with a p-value below 0.001.</li>
<li>There is <strong>no significant difference</strong> for <strong>milk temperature
between Rainy and Summer season</strong>. P-value = 0.299.</li>
<li>There is <strong>significant difference</strong> for <strong>milk temperature between
Summer and Winter season</strong>. P-value = below 0.001.</li>
<li>There is <strong>significant difference</strong> for <strong>milk temperature between
Rainy and Winter season</strong>. P-value = below 0.001.</li>
</ul>

<hr />

<h2 id="4-conclusion">4 Conclusion.</h2>

<p>Since there is a significant difference for milk temperature between
each season, this means that there is <strong>at least 1 mean that is
significantly different from the rest</strong>. This also means different season has
different effect on the milk temperature. The <strong>post-hoc result</strong> shows
that the <strong>average milk temperature</strong> for <strong>rainy and summer season</strong> is
<strong>significantly different from winter season</strong>.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">ggplot<span class="p">(</span>data<span class="o">=</span>CS.temp<span class="p">)</span> <span class="o">+</span>
    aes<span class="p">(</span>x<span class="o">=</span>Season<span class="p">,</span> y<span class="o">=</span>Temperature<span class="p">)</span> <span class="o">+</span>
    geom_boxplot<span class="p">()</span> <span class="o">+</span> 
    geom_hline<span class="p">(</span>yintercept<span class="o">=</span><span class="m">4.</span><span class="p">,</span> color<span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> alpha<span class="o">=</span><span class="m">.5</span><span class="p">)</span> <span class="o">+</span>
    geom_hline<span class="p">(</span>yintercept<span class="o">=</span><span class="m">2.</span><span class="p">,</span> color<span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> alpha<span class="o">=</span><span class="m">.5</span><span class="p">)</span></code></pre></div>
<p><img src="unnamed-chunk-21-1.png" alt="" /></p>

<hr />

<p><strong>Identify the source of the problem:</strong></p>

<p>Looking at the plot above, we can observe that rainy season has larger
variation than summer and winter seasons and lowest control over the
milk temperature. We can see that a small proportion of the temperature
exceeds above 4°C and below 2°C. Additionally, there is also a small
proportion of temperature that exceeds below 2°C during winter season,
but the violation is mild compare to rainy season. Summer season has the
highest control over milk temperature with fewer variation and no
violation.</p>

<p>Hence, the company should find out the reason behind the cause, and be
more cautious and prepared during winter and rainy season. Otherwise,
Cold Storage can cease collaborating with the company and search for
alternative company or solution.</p>

<hr />

<h2 id="5-notes-for-future-reference">5 Notes for future reference.</h2>

<p>Latest update: <strong>2020/01/31</strong></p>

<p><strong>List of things to take note:</strong></p>

<ul>
<li>Currently none.</li>
</ul>

    </div>
  </div>
  
</article>


        
                </div>
            </div>
        </div>


        
        <br>
        <footer class="footer text-center">
            <div class="container">
                <span class="text-muted">
                    Copyright &copy; Lionel Tay Yee Dang, <time datetime="2020">2020</time>.
                    
                </span>
            </div>
        </footer>


        
        <a id="custom_github" class="btn btn-primary btn-lg" href="https://github.com/lionelcub" role="button" title="Click to go to Gihub site" data-toggle="tooltip" data-placement="bottom">
            <i class="fab fa-github-alt"></i>
        </a>
        <a id="custom_back-to-top" class="btn btn-primary btn-lg back-to-top" href="#" role="button" title="Click to return to the top page" data-toggle="tooltip" data-placement="bottom">
            <i class="fas fa-caret-up"></i>
        </a>


        
        <script 
            src="https://code.jquery.com/jquery-3.3.1.slim.min.js" 
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" 
            crossorigin="anonymous"></script>
        <script 
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" 
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" 
            crossorigin="anonymous"></script>
        <script 
            src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" 
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" 
            crossorigin="anonymous"></script>

    </body>

</html>